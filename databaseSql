 Database Schema (PostgreSQL)

 -- users
CREATE TABLE users (
  id SERIAL PRIMARY KEY,
  phone VARCHAR(15) UNIQUE,
  email VARCHAR(100) UNIQUE,
  password_hash TEXT NOT NULL,
  name VARCHAR(50) NOT NULL,
  gender VARCHAR(10),
  birth_date DATE,
  bio TEXT,
  orientation VARCHAR(20),
  preferred_gender VARCHAR(10),
  min_age_pref INT DEFAULT 18,
  max_age_pref INT DEFAULT 99,
  max_distance_km INT DEFAULT 50,
  is_verified BOOLEAN DEFAULT FALSE,
  is_premium BOOLEAN DEFAULT FALSE,
  lat DECIMAL(9,6),
  lng DECIMAL(9,6),
  last_active TIMESTAMP DEFAULT NOW(),
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

-- user_photos
CREATE TABLE user_photos (
  id SERIAL PRIMARY KEY,
  user_id INT REFERENCES users(id) ON DELETE CASCADE,
  photo_url TEXT NOT NULL,
  is_primary BOOLEAN DEFAULT FALSE,
  face_score DECIMAL(3,2), -- quality score from facial analysis
  created_at TIMESTAMP DEFAULT NOW()
);

-- matches
CREATE TABLE matches (
  id SERIAL PRIMARY KEY,
  user_id_1 INT REFERENCES users(id),
  user_id_2 INT REFERENCES users(id),
  matched_at TIMESTAMP DEFAULT NOW(),
  status VARCHAR(10) DEFAULT 'active', -- active, blocked
  UNIQUE(user_id_1, user_id_2)
);

-- swipes
CREATE TABLE swipes (
  id SERIAL PRIMARY KEY,
  swiper_id INT REFERENCES users(id),
  swipee_id INT REFERENCES users(id),
  direction VARCHAR(10) CHECK (direction IN ('right', 'left')),
  created_at TIMESTAMP DEFAULT NOW(),
  UNIQUE(swiper_id, swipee_id)
);

-- chat_messages
CREATE TABLE chat_messages (
  id SERIAL PRIMARY KEY,
  match_id INT REFERENCES matches(id),
  sender_id INT REFERENCES users(id),
  message TEXT NOT NULL,
  read_status BOOLEAN DEFAULT FALSE,
  created_at TIMESTAMP DEFAULT NOW()
);

-- subscriptions
CREATE TABLE subscriptions (
  id SERIAL PRIMARY KEY,
  user_id INT REFERENCES users(id),
  stripe_subscription_id VARCHAR(100),
  plan VARCHAR(20) DEFAULT 'free', -- free, premium, vip
  start_date TIMESTAMP,
  end_date TIMESTAMP,
  status VARCHAR(10) DEFAULT 'active' -- active, canceled
);

-- boosts
CREATE TABLE boosts (
  id SERIAL PRIMARY KEY,
  user_id INT REFERENCES users(id),
  start_time TIMESTAMP,
  duration_minutes INT DEFAULT 30,
  active BOOLEAN DEFAULT TRUE
);